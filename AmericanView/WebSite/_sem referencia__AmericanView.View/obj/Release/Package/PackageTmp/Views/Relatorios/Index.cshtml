@{
    ViewBag.Title = "Relatórios";
}

@section breadcrumbs{
    <ol class="breadcrumb">
        <li><span class="glyphicon glyphicon-home"></span> <a href="@Url.Action("Index", "Home")" title="Home">Home</a></li>
        <li class="active">Relatórios</li>
    </ol>
}

@section scripts {
    <script src="@Url.Content("/Content/js/app/relatorios/relatorios.js")" type="text/javascript"></script>
    <script src="@Url.Content("/Content/js/app/relatorios/analitico.js")" type="text/javascript"></script>
    <script type="text/javascript">
        /* -- Setar Class em expand menu -- */
        window.onload = setActiveMenu;
        
        function setActiveMenu() {
            $('li#usuarios').addClass('active');
            $('.mini-nav ul li#usuarios ul').attr('style', 'display: none !important;');
        }

        $(document).ready(function () {
            GetBusiness();
            $('#collapseFilter').collapse('show');
            $('#accordion .panel .panel-heading').children('h4').children('small').children('span').removeAttr('class');
            $('#accordion .panel .panel-heading').children('h4').children('small').children('span').attr('class', 'glyphicon glyphicon-chevron-down');
        });

    </script>

    <script id="botaoRelatorioCruzamentoTemplate" type="text/x-kendo-template">
        # if(StatusId == "2") { #
        <a onclick='javascript: { ExibirRelatorioConciliacaoContabil(this); }' class='k-button' align='center'><span align='center' class='glyphicon glyphicon glyphicon-search'></span></a>
        # } else { #
        <a class='k-button' disabled><span class='glyphicon glyphicon glyphicon-search'></span></a>
        # } #
    </script>

    <script id="botaoRelatorioAnaliticoTemplate" type="text/x-kendo-template">
        # if(StatusId == "2") { #
        <a onclick='javascript: { AnalyticsDetails(this); }' class='k-button' align='center'><span align='center' class='glyphicon glyphicon glyphicon-search'></span></a>
        # } else { #
        <a class='k-button' disabled><span class='glyphicon glyphicon glyphicon-search'></span></a>
        # } #
    </script>

    <script id="botaoRelatorioGerencialTemplate" type="text/x-kendo-template">
        # if(StatusId == "2") { #
        <a onclick='javascript:{ManagerialDetails(this);}' class='k-button' align='center'><span align='center' class='glyphicon glyphicon glyphicon-search'></span></a>
        # } else { #
        <a class='k-button' disabled><span class='glyphicon glyphicon glyphicon-search'></span></a>
        # } #
    </script>

    <script id="botaoRelatorioSaldosTemplate" type="text/x-kendo-template">
        # if(StatusId == "2") { #
        <a onclick='javascript: { BalanceDetails(this); }' class='k-button' align='center'><span align='center' class='glyphicon glyphicon glyphicon-search'></span></a>
        # } else { #
        <a class='k-button' disabled><span class='glyphicon glyphicon glyphicon-search'></span></a>
        # } #
    </script>

    <script id="linkLogErroTemplate" type="text/x-kendo-template">
        # if(StatusId == "9") { #
            <a onclick='javascript: { ExibirErroApuracao(this); }' style='cursor: pointer;'>#=Status#</a>
        # } else { #
            <span>#=Status#</span>
        # } #
    </script>
}

<h1>Relatórios de Apuração de Tributos</h1>
<br />

@Html.Partial("_FilterReports")

<div class="row" style="margin-bottom: 15px;">
    <div class="col-sm-12">
        <div id="grid"></div>
    </div>
</div>

<div id="modalGerencial2" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="javascript: { FecharModal(this); }" aria-hidden="true">×</button>
                <center><h4 class="modal-title"><strong>Relatório Gerencial</strong></h4></center>
            </div>
            <div class="modal-body">
                <h3 class="body-message"></h3>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnCancelar" class="btn btn-success btn-xs" onclick="javascript: { FecharModal(this); }">
                    <span class="glyphicon glyphicon-remove"></span> Fechar
                </button>
                <button type="button" id="btnGerarPDF" class="btn btn-danger btn-xs" onclick="javascript: { GerarPDF(this, true); }">
                    <span class="glyphicon glyphicon-save"></span> Gerar PDF
                </button>
            </div>
        </div>
    </div>
</div>

<div id="modalSaldo" class="modal fade" style="width:1100px; left:150px;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">              
                <button type="button" class="close" onclick="javascript: { FecharModal(this); }" aria-hidden="true">×</button>
                <center><h4 class="modal-title"><strong>Relatório de Saldos</strong></h4></center>
            </div>
            <div class="modal-body">
                <h3 class="body-message"></h3>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnCancelar" class="btn btn-success btn-xs" onclick="javascript: { FecharModal(this); }">
                    <span class="glyphicon glyphicon-remove"></span> Fechar
                </button>
                <button type="button" id="btnGerarPDF" class="btn btn-danger btn-xs" onclick="javascript: { GerarPDF(this, true); }">
                    <span class="glyphicon glyphicon-save"></span> Gerar PDF
                </button>
            </div>
        </div>
    </div>
</div>

<div id="modalImprimir" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <center><h4 class="modal-title"><strong></strong></h4></center>
            </div>
            <div class="modal-body">
                <h3 class="body-message"></h3>
            </div>
        </div>
    </div>
</div>

<div id="modalCruzamentoNotas" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="javascript: { FecharModal(this); }" aria-hidden="true">×</button>
                <center><h4 class="modal-title"><strong>Cruzamento de Notas Fiscais X Lançamentos Contábeis</strong></h4></center>
            </div>
            <div class="modal-body"> 
                <input id="tbIdControle" hidden />                
                <div id="gridHeaderCruzamento"></div>
                <br />
                <h3 class="body-message">Detalhes do cruzamento</h3>
                <div id="gridDetalhesNotasFicais"></div>
                <div id="gridDetalhesLancamentos"></div>
                <div id="gridDetalhesValores"></div>
            </div>
            <div class="modal-footer">
                <button type="button" id="btnFechar" class="btn btn-success btn-xs" onclick="javascript: { FecharModal(this); }">
                    <span class="glyphicon glyphicon-remove"></span> Fechar
                </button>                
            </div>
        </div>
    </div>
</div>

<div id="modalErroApuracao" class="modal fade">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <center><h4 class="modal-title"><strong>Erro na Apuração</strong></h4></center>
            </div>
            <div class="modal-body"></div>
            <div class="modal-footer">
                <button type="button" id="btnFechar" class="btn btn-success btn-xs" onclick="javascript: { FecharModal(this); }">
                    <span class="glyphicon glyphicon-remove"></span> Fechar
                </button>
            </div>
        </div>
    </div>
</div>
